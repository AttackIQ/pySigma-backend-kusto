{"_ASIM_GetWatchlistsRaw": {"body": "let function = (watchlists:dynamic, keys:dynamic = dynamic([])) {\r\n  Watchlist\r\n  | where TimeGenerated < now() \r\n  | where _DTItemType == 'watchlist-item' \r\n  | where WatchlistAlias in (watchlists)\r\n  | where array_length(keys) == 0 or SearchKey in (keys)\r\n  | summarize hint.shufflekey=_DTItemId arg_max(_DTTimestamp, _DTItemStatus, LastUpdatedTimeUTC, SearchKey, WatchlistItem) by _DTItemId \r\n  | where _DTItemStatus != 'Delete' \r\n  | project-away _DTTimestamp, _DTItemStatus\r\n};\r\nfunction (watchlists,keys)", "params": "watchlists:dynamic, keys:dynamic = dynamic([])"}}