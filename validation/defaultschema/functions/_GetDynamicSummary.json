{"_GetDynamicSummary": {"body": "\r\nlet parser = (\r\n  dynamicSummaryName:string='*'\r\n ){\r\n DynamicSummary \r\n    | where TimeGenerated < now() \r\n    | where SummaryItemId == ''\r\n    | summarize arg_max(TimeGenerated,SummaryId, SummaryStatus) by SummaryName \r\n    | where SummaryName == dynamicSummaryName \r\n    | project SummaryId\r\n    | join kind=leftouter DynamicSummary on $left.SummaryId == $right.SummaryId\r\n    | where SummaryItemId == ''\r\n    | order by TimeGenerated desc\r\n    | extend important = case(SummaryStatus == \"Deleted\" and prev(SummaryStatus) == \"\" , true, case(SummaryStatus == \"Active\" and next(SummaryStatus) in (\"\",\"Deleted\"), true, false))\r\n    | where important == true\r\n    | top 1 by TimeGenerated desc\r\n    | where SummaryStatus == \"Active\"\r\n    | project SummaryId, oldestTimegenerated = TimeGenerated\r\n    | join kind=leftouter DynamicSummary on $left.SummaryId == $right.SummaryId\r\n    | where TimeGenerated > oldestTimegenerated and SummaryItemId != \"\"\r\n    | project-away SummaryId1, oldestTimegenerated\r\n};\r\nparser (dynamicSummaryName)\r\n", "params": "dynamicSummaryName:string = '*'"}}