{"_ASim_WebSession_NativeV01": {"body": "let parser=(disabled:bool=false) \r\n{\r\n  ASimWebSessionLogs  | where not(disabled)\r\n    // \r\n    // -- Schema fixed\r\n    | extend\r\n        FileSize = tolong(FileSize)\r\n    //\r\n    // -- Log Analytics global fields renaming\r\n    | project-rename\r\n        EventUid          = _ItemId,\r\n        DvcScopeId        = _SubscriptionId\r\n    //\r\n    // -- ASIM Global fields\r\n    | extend          \r\n        EventSchema       = \"WebSession\"\r\n    | extend\r\n        //\r\n        // -- Default values\r\n        EventEndTime      = coalesce (EventEndTime, TimeGenerated),\r\n        EventStartTime    = coalesce (EventStartTime, TimeGenerated),\r\n        //\r\n        // -- Multi-source aliases\r\n        Dvc = iff (EventType == 'HTTPSession',\r\n          coalesce (DvcFQDN, DvcHostname, DvcIpAddr, DvcId, DstMacAddr, _ResourceId, strcat (EventVendor,'/', EventProduct)),\r\n          coalesce (DvcFQDN, DvcHostname, DstFQDN, DstHostname, DvcIpAddr, DstIpAddr, DvcId, DstDvcId, DstMacAddr, _ResourceId, strcat (EventVendor,'/', EventProduct))\r\n        ),\r\n        Dst               = coalesce (DstFQDN, DstHostname, DstIpAddr, DstDvcId),\r\n        Src               = coalesce (SrcFQDN, SrcHostname, SrcIpAddr, SrcDvcId),\r\n        Rule              = coalesce(RuleName, tostring(RuleNumber)),\r\n        //\r\n        // -- Aliases which depend on EventType\r\n        Hostname = iff  (EventType == \"EndpointNetworkSession\" and NetworkDirection == (\"Inbound\"), SrcHostname, DstHostname),\r\n        IpAddr = iff  (EventType == \"EndpointNetworkSession\" and NetworkDirection == (\"Inbound\"), DstIpAddr, SrcIpAddr),\r\n        //\r\n        // -- Simple aliases\r\n        Duration          = NetworkDuration,\r\n        SessionId         = NetworkSessionId,\r\n        User              = SrcUsername,\r\n        HttpStatusCode    = EventResultDetails,\r\n        UserAgent         = HttpUserAgent\r\n        // --\r\n        // -- Aliased fields not implemented in ASimWebSessionLogs yet \r\n        //InnerVlanId     = SrcVlanId,\r\n        //OuterVlanId     = DstVlanId,\r\n        //DvcInterface    = coalesce(DvcInterface, DvcInboundInterface, DvcOutboundInterface), \r\n    | project-away\r\n        TenantId, SourceSystem, _ResourceId\r\n};\r\nparser  (disabled=disabled)\r\n", "params": "disabled:bool = false"}}