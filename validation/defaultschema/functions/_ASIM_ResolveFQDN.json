{"_ASIM_ResolveFQDN": {"body": "T\r\n| extend ExtractedHostname = column_ifexists (field,'')\r\n| extend DotSplitHostname = split(ExtractedHostname,\".\")\r\n| extend SlashSplitHostname = split(ExtractedHostname,\"\\\\\")\r\n| extend DomainType = case(\r\n    array_length(SlashSplitHostname) > 1, \"Windows\",\r\n    array_length(DotSplitHostname) > 1, \"FQDN\",\r\n    \"\"\r\n)\r\n| extend \r\n    FQDN = iif (DomainType == '', '', ExtractedHostname),\r\n    Domain = case (\r\n        DomainType == \"Windows\", SlashSplitHostname[0],\r\n        DomainType == \"FQDN\", tostring(strcat_array(array_slice(DotSplitHostname, 1, -1), '.')),\r\n        \"\"),\r\n    ExtractedHostname = case (\r\n        DomainType == \"Windows\", SlashSplitHostname[1],\r\n        DomainType == \"FQDN\", DotSplitHostname[0],\r\n        ExtractedHostname)   \r\n| project-away DotSplitHostname, SlashSplitHostname\r\n", "params": "T:(*), field:string"}}