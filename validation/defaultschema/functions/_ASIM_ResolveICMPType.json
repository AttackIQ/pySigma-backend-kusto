{"_ASIM_ResolveICMPType": {"body": "let NetworkIcmpTypeLookup = datatable(NetworkIcmpCode:int, NetworkIcmpType:string) [\r\n  0,\"Echo Reply\",\r\n  1,\"Unassigned\",\r\n  2,\"Unassigned\",\r\n  3,\"Destination Unreachable\",\r\n  4,\"Source Quench (Deprecated)\",\r\n  5,\"Redirect\",\r\n  6,\"Alternate Host Address (Deprecated)\",\r\n  7,\"Unassigned\",\r\n  8,\"Echo\",\r\n  9,\"Router Advertisement\",\r\n  10,\"Router Solicitation\",\r\n  11,\"Time Exceeded\",\r\n  12,\"Parameter Problem\",\r\n  13,\"Timestamp\",\r\n  14,\"Timestamp Reply\",\r\n  15,\"Information Request (Deprecated)\",\r\n  16,\"Information Reply (Deprecated)\",\r\n  17,\"Address Mask Request (Deprecated)\",\r\n  18,\"Address Mask Reply (Deprecated)\",\r\n  19,\"Reserved (for Security)\",\r\n  20,\"Reserved (for Robustness Experiment)\", \r\n  21,\"Reserved (for Robustness Experiment)\",\r\n  22,\"Reserved (for Robustness Experiment)\",\r\n  23,\"Reserved (for Robustness Experiment)\",\r\n  24,\"Reserved (for Robustness Experiment)\",\r\n  25,\"Reserved (for Robustness Experiment)\",\r\n  26,\"Reserved (for Robustness Experiment)\",\r\n  27,\"Reserved (for Robustness Experiment)\",\r\n  28,\"Reserved (for Robustness Experiment)\",\r\n  29,\"Reserved (for Robustness Experiment)\",\r\n  30,\"Traceroute (Deprecated)\",\r\n  31,\"Datagram Conversion Error (Deprecated)\",\r\n  32,\"Mobile Host Redirect (Deprecated)\",\r\n  33,\"IPv6 Where-Are-You (Deprecated)\",\r\n  34,\"IPv6 I-Am-Here (Deprecated)\",\r\n  35,\"Mobile Registration Request (Deprecated)\",\r\n  36,\"Mobile Registration Reply (Deprecated)\",\r\n  37,\"Domain Name Request (Deprecated)\",\r\n  38,\"Domain Name Reply (Deprecated)\",\r\n  39,\"SKIP (Deprecated)\",\r\n  40,\"Photuris\",\r\n  41,\"ICMP messages utilized by experimental mobility protocols such as Seamoby\",\r\n  42,\"Extended Echo Request\",\r\n  43,\"Extended Echo Reply\",\r\n  253,\"RFC3692-style Experiment 1\",\r\n  254,\"RFC3692-style Experiment 2\",\r\n  255,\"Reserved\"   \r\n];\r\nT\r\n| extend NetworkIcmpCode = toint(column_ifexists(field,0))\r\n| lookup NetworkIcmpTypeLookup on NetworkIcmpCode\r\n| extend NetworkIcmpType = \r\n  case (\r\n    NetworkIcmpType != \"\", NetworkIcmpType,\r\n    'Unassigned'\r\n  )\r\n", "params": "T:(*), field:string"}}