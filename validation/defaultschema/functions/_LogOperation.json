{"_LogOperation": {"body": "Operation | where OperationKey != 'Custom log ingestion' | extend Category = case( OperationCategory == 'JSON handler', 'Ingestion', OperationCategory == 'Data Collection Status', 'Ingestion', OperationCategory == 'ConfigurationScope', 'Solution Targeting', OperationCategory == 'Azure Activity Log Collection', 'Data Collection', OperationCategory == 'Active Directory Group Collection', 'Data Collection', OperationCategory == 'WSUS Client Group Collection', 'Data Collection', OperationCategory == 'Workspace Configuration', 'Data Collection', OperationCategory == 'OMS Auditd Plugin issue', 'Agent', OperationCategory == 'OMS Agent for Linux issue', 'Agent', OperationCategory == 'OMS Agent for Linux buffer is 90% full', 'Agent', OperationCategory == 'Assessment Execution', 'Assessment Solution', OperationCategory == 'Is Local Administrator Check', 'Assessment Solution', OperationCategory == '.Net 4.0 Check', 'Assessment Solution', OperationCategory == 'Assessment Target Check', 'Assessment Solution', OperationCategory == 'Security Baseline', 'Assessment Solution', OperationCategory ) | extend Level= case( OperationStatus == 'Failed' and OperationCategory == 'JSON handler', 'Warning', OperationStatus == 'Failed' and OperationCategory == 'JSON handler', 'Warning', OperationStatus == 'Failed' and OperationCategory == 'Azure Activity Log Collection', 'Warning', OperationStatus == 'Failed' and Category == 'Data Collection', 'Info', OperationStatus == 'Failed', 'Error', OperationStatus == 'InvalidSyntax', 'Error', OperationStatus == 'Succeeded' and OperationCategory == 'JSON handler', 'Warning', OperationStatus == 'Warning', 'Warning', 'Info' ) | extend Operation= case( Category == 'Ingestion' and OperationKey == 'Data is too old', 'Data is older then set days', Category == 'Ingestion' and OperationKey == 'Storage creds', 'Storage', Category == 'Ingestion' and OperationKey == 'Ingestion rate limit', 'Ingestion rate', Category == 'Ingestion' and OperationKey == 'Storage creds', 'Storage', OperationCategory == 'Data Collection Machine Check', 'Data Collection Machine Check', Category == 'Ingestion' , OperationKey, OperationCategory == 'Data Collection Status' and OperationStatus == 'Succeeded', 'Data collection resuming', OperationCategory == 'Data Collection Status' and OperationStatus == 'Warning', 'Data collection stopped', OperationCategory == 'OMS Auditd Plugin issue', 'Auditd Plugin issue', Category == 'Agent', 'Linux Agent', OperationCategory ) | extend Level= iff(Operation == 'Auditd Plugin issue' or Operation == 'Linux Agent', 'Info', Level) | extend Description = case( Operation == 'Azure Activity Log Collection','Subscription was deleted or insufficient permissions. Consider disabling Activity Logs collection from this subscription. Please view http://aka.ms/DisablingActivityLogsCollection for more info.', OperationCategory == 'OMS Agent for Linux buffer is 90% full','OMS Agent for Linux buffer queue is 90% full - adjust agent configuration for higher throughput.', '' ) | project TimeGenerated, Category, Operation, Level, Detail = strcat(Detail,iff(isnotempty(Description), strcat('\\n', Description), '') ,iff(isnotempty(HelpLink), strcat(' ', HelpLink), '') ), _ResourceId, Computer, CorrelationId", "params": null}}